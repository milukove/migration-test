var j=(l,p,b)=>{if(!p.has(l))throw TypeError("Cannot "+b)};var c=(l,p,b)=>(j(l,p,"read from private field"),b?b.call(l):p.get(l)),o=(l,p,b)=>{if(p.has(l))throw TypeError("Cannot add the same private member more than once");p instanceof WeakSet?p.add(l):p.set(l,b)},w=(l,p,b,f)=>(j(l,p,"write to private field"),f?f.call(l,b):p.set(l,b),b);var h=(l,p,b)=>(j(l,p,"access private method"),b);(function(l){typeof define=="function"&&define.amd?define(l):l()})(function(){var U,_,g,m,T,I,S,X,R,Z,V,H,$,tt,M,et,O,F,D,st,k,z,E,it,x,at,C,rt,L,nt,G,ct,q,ot,J,ut,Y,ht;"use strict";const l=/(\d+)\D+(\d+)\D+(\d+)/;function p(n){const t=l.exec(n);if(t&&t.length===4)return t.slice(1,4).map(e=>parseInt(e,10))}function b(n,t){let e;n.hasAttribute(t)?e=n.getAttribute(t):e=n.getAttribute("value");const s=p(e);let r=e;return s&&(r=s),r}const f="data-av-multiproperty",N="data-av-property",B="data-av-value";async function lt(n,t,{isDefault:e}={}){if(n.hasAttribute(N)){const r=n.getAttribute(N).split(",");let i;n.hasAttribute(B)?i=n.getAttribute(B):i=n.value;let a=i;if(i==="true")a=!0;else if(i==="false")a=!1;else{const u=p(i);u&&(a=u)}const d=r.filter(u=>u.trim()).map(u=>t.setValue(u.trim(),a,n,!1,{isDefault:e}));await Promise.all(d)}}async function dt(n,t,{isDefault:e}={}){const i=n.getAttribute(N).split(",").filter(a=>a.trim()).map(a=>t.setValue(a.trim(),n.checked,n,!1,{isDefault:e}));await Promise.all(i)}async function ft(n,t,{isDefault:e}={}){const r=n.getAttribute(N).split(","),i=n.value,a=[],d=i.replace(/^#/,"");a.push(parseInt(d.slice(0,2),16)),a.push(parseInt(d.slice(2,4),16)),a.push(parseInt(d.slice(4,6),16));const u=r.filter(A=>A.trim()).map(A=>t.setValue(A.trim(),a,n,!1,{isDefault:e}));await Promise.all(u)}function pt(n,t,e){let s=n.querySelectorAll(`[${N}], [${f}]`);return s=Array.from(s),t&&n.nodeName==="OPTION"&&n.hasAttribute(f)&&!e.has(n.parentNode)&&s.push(n),s.filter(a=>a.hasAttribute(f)&&a.nodeName==="OPTION").forEach(a=>{s.splice(s.indexOf(a),1),s.includes(a.parentNode)||s.push(a.parentNode)}),s.filter(a=>a.hasAttribute(f)&&a.nodeName==="INPUT"&&a.getAttribute("type")==="radio").forEach(a=>{s.splice(s.indexOf(a),1),s.includes(a.parentNode)||s.push(a.parentNode)}),s}async function K(n,t,e,{isDefault:s}={}){if(n.hasAttribute(f)){const r=n.getAttribute(f);let i;try{i=JSON.parse(r)}catch(A){try{i=JSON.parse(r.replace(/'/g,'"'))}catch{e==null||e.error(`The ${f} attribute cannot be parsed. ${A}`);return}}const d=(n.getAttribute(N)||"").split(","),u=i.map(A=>{const y=Object.keys(A)[0],v=A[y];return d.some(mt=>mt.trim()===y)&&(e==null||e.warn(`The property ${y} is updated by both the ${N} and ${f} attributes, the value from the ${f} attribute will be applied last.`)),t.setValue(y,v,n,!1,{isDefault:s})});await Promise.all(u)}}async function bt(n,t,e,{isDefault:s}={}){if(n.hasAttribute(N)){const r=n.getAttribute(N),i=r.split(",");let a,d;for(let y=0;y<t.length;y+=1){const v=t.item(y);if(v.type==="radio"&&v.name===r&&v.checked){a=v,d=v.getAttribute(B)||v.getAttribute("value");break}}const u=p(d);let A=d;u&&(A=u);const W=i.filter(y=>y.trim()).map(y=>e.setValue(y.trim(),A,a,!1,{isDefault:s}));await Promise.all(W)}}async function Nt(n,t,e,{isDefault:s}={}){if(n.hasAttribute(N)){const i=n.getAttribute(N).split(","),a=b(t,B),d=i.filter(u=>u.trim()).map(u=>e.setValue(u.trim(),a,t,!1,{isDefault:s}));await Promise.all(d)}}const At="data-av-binding-id",Tt="data-av-default",P="data-av-event",Q="data-av-bound-event";class yt{constructor(t){o(this,S);o(this,R);o(this,V);o(this,$);o(this,M);o(this,O);o(this,D);o(this,k);o(this,E);o(this,x);o(this,C);o(this,L);o(this,G);o(this,q);o(this,J);o(this,Y);o(this,U,void 0);o(this,_,void 0);o(this,g,void 0);o(this,m,void 0);o(this,T,void 0);o(this,I,void 0);w(this,I,t),w(this,g,new Map),w(this,m,new Map)}async init(t,e,s){w(this,T,t),w(this,U,e),s&&w(this,_,new s("DOM Binding")),h(this,S,X).call(this),await h(this,k,z).call(this),h(this,V,H).call(this)}}U=new WeakMap,_=new WeakMap,g=new WeakMap,m=new WeakMap,T=new WeakMap,I=new WeakMap,S=new WeakSet,X=function(){new MutationObserver(h(this,R,Z).bind(this)).observe(c(this,I),{attributeOldValue:!0,attributes:!0,childList:!0,subtree:!0})},R=new WeakSet,Z=async function(t){const e=[];t.forEach(s=>{const{addedNodes:r,removedNodes:i}=s;s.type==="attributes"&&r.length===0&&i.length===0&&(h(this,O,F).call(this,s.target,!1,s.oldValue),h(this,V,H).call(this,s.target)),i.forEach(a=>{a instanceof HTMLElement&&(h(this,J,ut).call(this,a),h(this,O,F).call(this,a,!0))}),r.forEach(a=>{a instanceof HTMLElement&&(e.push(h(this,k,z).call(this,a,!0)),e.push(h(this,V,H).call(this,a)))})}),await Promise.all(e)},V=new WeakSet,H=function(t){const e=[];t&&t.hasAttribute(P)&&e.push(t),e.push(...(t||c(this,I)).querySelectorAll(`[${P}]`)),e.forEach(s=>{h(this,$,tt).call(this,s)})},$=new WeakSet,tt=function(t){const e=h(this,M,et).bind(this,t);let s=t.getAttribute(Q);s||(s="click"),c(this,g).set(t,e),t.addEventListener(s,e)},M=new WeakSet,et=async function(t){const r=t.getAttribute(P).split(",").filter(i=>i.trim()).map(i=>{const a=i.trim();return c(this,T).triggerEvent(a,!1)});await Promise.all(r)},O=new WeakSet,F=function(t,e,s){const r=[];t.hasAttribute(P)&&r.push(t),r.push(...t.querySelectorAll(`[${P}]`)),r.forEach(i=>{h(this,D,st).call(this,i,e,s)})},D=new WeakSet,st=function(t,e,s){let r=s;r||(e?r=t.getAttribute(Q)||"click":r="click");const i=c(this,g).get(t);t.removeEventListener(r,i),c(this,g).delete(t)},k=new WeakSet,z=async function(t=void 0,e=!1){const r=pt(t||c(this,I),!!t,c(this,m)).map(i=>h(this,E,it).call(this,i,e));await Promise.all(r)},E=new WeakSet,it=async function(t,e){const s=u=>{var A;(A=c(this,_))==null||A.warn(`Unsupported element for ${u} binding ${t.nodeName}`)};let r,i="change",a=!0;switch(t.nodeName){case"AV-NATIVE-BUTTON-STATE":return;case"BUTTON":r=h(this,x,at),i="click",a=!e&&t.hasAttribute(Tt);break;case"DIV":r=h(this,G,ct);break;case"INPUT":const u=t.getAttribute("type");if(u==="checkbox"){if(t.hasAttribute(f)){s("multiproperty");return}r=h(this,C,rt)}else if(u==="color"){if(t.hasAttribute(f)){s("multiproperty");return}r=h(this,L,nt)}else{s("property");return}break;case"SELECT":r=h(this,q,ot);break;default:s("property");return}const d=r.bind(this,t);c(this,m).set(t,d),a&&await d(t,{isDefault:!0}),t.addEventListener(i,d)},x=new WeakSet,at=async function(t,e,{isDefault:s}={}){await lt(t,c(this,T),{isDefault:s}),await K(t,c(this,T),c(this,_),{isDefault:s})},C=new WeakSet,rt=async function(t,e,{isDefault:s}={}){await dt(t,c(this,T),{isDefault:s})},L=new WeakSet,nt=async function(t,e,{isDefault:s}={}){await ft(t,c(this,T),{isDefault:s})},G=new WeakSet,ct=async function(t,e,{isDefault:s}={}){const r=t.getElementsByTagName("input");await bt(t,r,c(this,T),{isDefault:s});let i;for(let a=0;a<r.length;a+=1){const d=r.item(a);if(d.checked){i=d;break}}i&&await K(i,c(this,T),c(this,_),{isDefault:s})},q=new WeakSet,ot=async function(t,e,{isDefault:s}={}){const i=t.getElementsByTagName("option").item(t.selectedIndex);await Nt(t,i,c(this,T),{isDefault:s}),await K(i,c(this,T),c(this,_),{isDefault:s})},J=new WeakSet,ut=function(t){const e=[];(t.hasAttribute(N)||t.hasAttribute(f))&&e.push(t),e.push(...t.querySelectorAll(`[${N}], [${f}]`)),e.filter(i=>i.hasAttribute(f)&&i.nodeName==="OPTION").forEach(i=>{e.splice(e.indexOf(i),1),e.includes(i.parentNode)||e.push(i.parentNode)}),e.filter(i=>i.hasAttribute(f)&&i.nodeName==="INPUT"&&i.getAttribute("type")==="radio").forEach(i=>{e.splice(e.indexOf(i),1),e.includes(i.parentNode)||e.push(i.parentNode)}),e.forEach(i=>{h(this,Y,ht).call(this,i)})},Y=new WeakSet,ht=function(t){const e=i=>{var a;(a=c(this,_))==null||a.warn(`Unsupported element for ${i} binding ${t.nodeName}`)};let s="change";switch(t.nodeName){case"BUTTON":s="click";break;case"INPUT":const i=t.getAttribute("type");if(i!=="checkbox"&&i!=="color"){e("property");return}if(t.hasAttribute(f)&&!t.hasAttribute(N)){e("multiproperty");return}break;default:if(t.nodeName!=="DIV"&&t.nodeName!=="SELECT"){e("property");return}}const r=c(this,m).get(t);t.removeEventListener(s,r),c(this,m).delete(t)};function _t(n){let t=n?document.querySelector(`[${At} = ${n}]`):void 0;return t||(t=document),new yt(t)}window.atlatlVisualBinding={construct:_t}});
